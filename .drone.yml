---
kind: pipeline
name: python3-6

steps:
- name: test
  image: python:3.6
  commands:
  - pip3 install -r requirements.txt -r requirements-dev.txt
  - coverage run --source=jj -m unittest tests
  - coverage xml
- name: coverage
  image: plugins/codecov
  settings:
    required: true
    token:
      from_secret: codecov-token
    files:
    - coverage.xml

trigger:
  event:
    - push

---
kind: pipeline
name: python3-7

steps:
- name: test
  image: python:3.7
  commands:
  - pip3 install -r requirements.txt -r requirements-dev.txt
  - python3 -m unittest tests

trigger:
  event:
    - push

---
kind: pipeline
name: pypy3-6

steps:
- name: test
  image: pypy:3.6-7.0-slim
  commands:
  - pip3 install -r requirements.txt
  - pip3 install asynctest
  - pypy3 -m unittest tests

trigger:
  event:
    - push

---
kind: signature
hmac: f1a2e909c45d94818427f0f077b8540c8fcb39f1ad48f33107281934225b61b5
